# 마이그레이션 대비 누락 속성 정리 (Missing Schema Analysis)

**프로젝트:** Habitree Reading Hub v4.0.0  
**작성일:** 2026년 1월 12일  

---

## 1. 개요
노션 독서 리스트 데이터베이스 분석 결과, 현재 시스템의 데이터베이스 스키마(`schema.sql`)에 존재하지 않는 속성들이 확인되었습니다. 데이터 유실 없는 마이그레이션을 위해 추가가 필요한 항목들을 다음과 같이 정리합니다.

---

## 2. 테이블별 추가 필요 컬럼

### 2.1 `books` 테이블 (도서 정보)
기존에 도서 제목과 저자 외에 수집되던 메타데이터를 저장할 공간이 필요합니다.

| 추가 컬럼명 | 노션 속성명 | 데이터 타입 | 용도 및 비고 |
| :--- | :--- | :--- | :--- |
| **`category`** | 유형 | `VARCHAR(100)` | 소설, 자기계발, 인문 등 도서 분류 |
| **`total_pages`** | 페이지 수 | `INTEGER` | 도서의 전체 페이지 수 |
| **`summary`** | 책소개 | `TEXT` | 출판사 제공 또는 사용자가 기록한 책 소개 |
| **`external_link`**| 네이버 링크 | `TEXT` | 도서 검색 및 구매 페이지 연결용 URL |

### 2.2 `user_books` 테이블 (사용자 독서 정보)
사용자 개인의 주관적인 평가 및 독서 환경에 대한 정보입니다.

| 추가 컬럼명 | 노션 속성명 | 데이터 타입 | 용도 및 비고 |
| :--- | :--- | :--- | :--- |
| **`rating`** | score | `DECIMAL(3, 1)` | 사용자 별점 (예: 4.5) |
| **`book_format`** | 읽는 책종류 | `VARCHAR(50)` | 종이책, 전자책, 종이+전자 등 독서 매체 |

---

## 3. 속성값 매핑 계획

### 3.1 독서 상태 (reading_status)
현재 시스템의 ENUM 타입과 노션의 선택 속성 값을 다음과 같이 매핑합니다.

| 노션 값 (Status) | 시스템 매핑 값 (Enum) | 비고 |
| :--- | :--- | :--- |
| **읽기전** | `not_started` | |
| **읽는중 / 필사중** | `reading` | '필사중'은 현재 시스템에서 '읽는중'의 특수한 케이스로 처리 |
| **완독** | `completed` | |
| **재독** | `rereading` | |
| - | `paused` | 현재 노션에는 없으나 시스템 지원 예정 |

---

## 4. 향후 작업 단계
1. **스키마 변경(Migration)**: 위 내용을 반영한 SQL 마이그레이션 파일을 생성하여 데이터베이스에 적용합니다.
2. **데이터 추출(Export)**: 노션에서 CSV 데이터를 추출할 때 위 컬럼들에 데이터가 정확히 포함되도록 확인합니다.
3. **매핑 스크립트 수정**: 마이그레이션 스크립트에 새롭게 추가된 컬럼들을 포함하여 주입(Insert) 로직을 보완합니다.

---
> [!NOTE]
> 위 컬럼들 중 반드시 필요한 항목을 확정해 주시면 즉시 마이그레이션 파일 작성을 시작하겠습니다.
