# Phase 4: 기록 관리 기능 테스트 (고급 - 이미지/OCR)

**단계:** 4/9  
**예상 소요 시간:** 15-20분  
**필수 선행 조건:** Phase 3 완료 (기본 기록 작성 완료)

---

## 🎯 테스트 목표

1. 이미지 업로드가 정상 작동하는지 확인
2. 이미지 압축이 정상 작동하는지 확인
3. 필사 이미지 기록 작성이 정상 작동하는지 확인
4. OCR 처리 요청이 정상 작동하는지 확인
5. OCR 결과가 정상적으로 저장되는지 확인

---

## 📋 테스트 시나리오

### 시나리오 4-1: 이미지 업로드 (사진 기록)

**프롬프트:**
```
기록 작성 페이지에서:

1. 기록 유형을 "사진"으로 선택합니다
2. "이미지 업로드" 버튼을 클릭합니다
3. 이미지 파일을 선택합니다 (JPG, PNG, WEBP, HEIC 형식)
4. 이미지 업로드 진행 상황이 표시되는지 확인합니다
5. 이미지가 성공적으로 업로드되었는지 확인합니다 (미리보기 표시)
6. 개발자 도구 콘솔에서 에러가 없는지 확인합니다
7. 네트워크 탭에서 이미지 업로드 API 요청이 성공적으로 완료되었는지 확인합니다

확인 사항:
- 이미지 선택이 정상적으로 작동하는가?
- 이미지 업로드 진행 상황이 표시되는가?
- 업로드된 이미지 미리보기가 정상적으로 표시되는가?
- 파일 크기 제한(5MB)이 작동하는가?
- 지원하지 않는 파일 형식에 대한 에러 메시지가 표시되는가?
```

**예상 결과:**
- 이미지 업로드 성공
- 이미지 미리보기 표시
- 파일 크기 초과 시 에러 메시지
- 지원하지 않는 형식 시 에러 메시지

---

### 시나리오 4-2: 이미지 압축 (대용량 이미지)

**프롬프트:**
```
5MB 이상의 대용량 이미지를 업로드합니다:

1. 5MB 이상의 이미지 파일을 선택합니다
2. 이미지 압축이 자동으로 진행되는지 확인합니다
3. 압축된 이미지가 업로드되는지 확인합니다
4. 개발자 도구 콘솔에서 에러가 없는지 확인합니다
5. 네트워크 탭에서 이미지 압축 및 업로드 요청이 성공적으로 완료되었는지 확인합니다

확인 사항:
- 대용량 이미지가 자동으로 압축되는가?
- 압축 후에도 이미지 품질이 적절한가?
- 압축 과정에서 에러가 발생하지 않는가?
```

**예상 결과:**
- 이미지 자동 압축
- 압축된 이미지 업로드 성공
- 이미지 품질 적절히 유지

---

### 시나리오 4-3: 필사 이미지 기록 작성

**프롬프트:**
```
기록 작성 페이지에서:

1. 기록 유형을 "필사 이미지"로 선택합니다
2. 이미지를 업로드합니다
3. 기록 내용을 입력합니다 (선택사항, OCR 결과로 자동 채워질 수 있음)
4. 페이지 번호를 입력합니다 (선택사항)
5. 태그를 추가합니다 (선택사항)
6. "저장" 버튼을 클릭합니다
7. 기록이 성공적으로 저장되었는지 확인합니다
8. 개발자 도구 콘솔에서 에러가 없는지 확인합니다

확인 사항:
- 필사 이미지 기록 작성이 정상적으로 작동하는가?
- 이미지가 기록에 정상적으로 저장되는가?
- 기록 상세 페이지에서 이미지가 정상적으로 표시되는가?
```

**예상 결과:**
- 필사 이미지 기록 성공적으로 저장
- 기록 상세 페이지에서 이미지 정상 표시

---

### 시나리오 4-4: OCR 처리 요청

**프롬프트:**
```
필사 이미지 기록을 작성한 후:

1. 기록이 성공적으로 저장되었는지 확인합니다
2. OCR 처리 요청이 자동으로 시작되는지 확인합니다 (토스트 메시지 또는 로딩 표시)
3. 개발자 도구 콘솔에서 OCR 요청이 성공적으로 전송되었는지 확인합니다
4. 네트워크 탭에서 OCR 요청 API(/api/ocr)가 성공적으로 호출되었는지 확인합니다
5. OCR 처리가 비동기로 진행되는지 확인합니다 (즉시 응답, 백그라운드 처리)

확인 사항:
- OCR 처리 요청이 자동으로 시작되는가?
- OCR 처리가 비동기로 진행되는가? (페이지가 블로킹되지 않음)
- OCR 요청이 성공적으로 전송되는가?
```

**예상 결과:**
- OCR 처리 요청 성공
- 비동기 처리 확인
- 즉시 응답 (백그라운드 처리)

---

### 시나리오 4-5: OCR 결과 확인

**프롬프트:**
```
OCR 처리 요청 후:

1. 몇 초 후 기록 상세 페이지를 새로고침합니다
2. OCR 결과가 기록 내용에 자동으로 채워졌는지 확인합니다
3. 추출된 텍스트가 정확한지 확인합니다 (한글, 영어, 숫자, 특수문자)
4. 줄바꿈과 문단이 정확하게 보존되었는지 확인합니다
5. 개발자 도구 콘솔에서 에러가 없는지 확인합니다
6. 네트워크 탭에서 OCR 처리 API(/api/ocr/process)가 성공적으로 완료되었는지 확인합니다

확인 사항:
- OCR 결과가 자동으로 기록 내용에 저장되는가?
- 추출된 텍스트가 정확한가?
- 줄바꿈과 문단이 정확하게 보존되는가?
- OCR 처리 실패 시 적절한 에러 메시지가 표시되는가?
```

**예상 결과:**
- OCR 결과 자동 저장
- 추출된 텍스트 정확
- 줄바꿈과 문단 보존
- OCR 처리 실패 시 에러 메시지 표시

---

### 시나리오 4-6: OCR 결과 수정

**프롬프트:**
```
OCR 결과가 저장된 기록에서:

1. 기록 상세 페이지에서 "수정" 버튼을 클릭합니다
2. OCR 결과로 자동 채워진 내용을 확인합니다
3. 내용을 수정합니다
4. "저장" 버튼을 클릭합니다
5. 수정된 내용이 정상적으로 저장되는지 확인합니다

확인 사항:
- OCR 결과를 수정할 수 있는가?
- 수정된 내용이 정상적으로 저장되는가?
```

**예상 결과:**
- OCR 결과 수정 가능
- 수정된 내용 정상 저장

---

### 시나리오 4-7: 이미지가 포함된 기록 삭제

**프롬프트:**
```
이미지가 포함된 기록을 삭제합니다:

1. 이미지가 포함된 기록 상세 페이지에서 "삭제" 버튼을 클릭합니다
2. 삭제 확인 다이얼로그가 표시되는지 확인합니다
3. 삭제를 확인합니다
4. 기록이 성공적으로 삭제되었는지 확인합니다
5. 개발자 도구 콘솔에서 에러가 없는지 확인합니다
6. 네트워크 탭에서 이미지 삭제 요청이 성공적으로 완료되었는지 확인합니다

확인 사항:
- 이미지가 포함된 기록 삭제가 정상적으로 작동하는가?
- 기록 삭제 시 이미지 파일도 함께 삭제되는가?
- 삭제 후 적절한 페이지로 리다이렉트되는가?
```

**예상 결과:**
- 기록 삭제 성공
- 이미지 파일도 함께 삭제
- 기록 목록 또는 책 상세 페이지로 리다이렉트

---

## ✅ 체크리스트

각 시나리오를 완료한 후 다음을 확인하세요:

- [ ] 이미지 업로드가 정상 작동함
- [ ] 이미지 압축이 정상 작동함
- [ ] 필사 이미지 기록 작성이 정상 작동함
- [ ] OCR 처리 요청이 정상 작동함
- [ ] OCR 결과가 정상적으로 저장됨
- [ ] OCR 결과 수정이 정상 작동함
- [ ] 이미지가 포함된 기록 삭제가 정상 작동함
- [ ] 에러 없이 모든 기능이 작동함

---

## 🐛 발견 사항 기록

### 정상 작동 기능
- 

### 발견된 버그
- 

### 개선 제안
- 

### 성능 이슈
- 

---

## 📸 스크린샷 (필요시)

중요한 화면이나 에러 발생 시 스크린샷을 첨부하세요.

---

## ➡️ 다음 단계

Phase 4가 완료되면 **Phase 5: 검색 기능 테스트**로 진행하세요.

---

**문서 끝**

